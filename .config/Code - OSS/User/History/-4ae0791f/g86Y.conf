general {
    # Lock before sleep (optional)
    lock_cmd = loginctl lock-session

    # Turn screens off before sleep
    before_sleep_cmd = hyprctl dispatch dpms off

    # Restore screens after wake
    after_sleep_cmd = hyprctl dispatch dpms on
}

# ========== LID ==========
# Turn laptop panel off when lid closes
listener {
    timeout = 0
    on-lid-close = hyprctl dispatch dpms off eDP-1
    on-lid-open  = hyprctl dispatch dpms on eDP-1
}

# ========== IDLE → SCREEN OFF ==========
# After 5 min of no activity, turn off displays
# But do NOT trigger while audio/video/games are running
listener {
    timeout = 300
    on-timeout = hyprctl dispatch dpms off
    on-resume  = hyprctl dispatch dpms on
    inhibit = true
}

# ========== IDLE → SUSPEND ==========
# After 15 min of idle, suspend system
# Blocked when video, games, or audio is active
listener {
    timeout = 500
    on-timeout = systemctl suspend
    inhibit = true
}

# ========== LID CLOSED → SUSPEND ==========
# If lid is closed for 10 minutes, sleep
listener {
    timeout = 600
    on-timeout = systemctl suspend
}

# ========== AC POWER MODE ==========
# On AC power, do NOT auto suspend
listener {
    timeout = 0
    on-ac = systemctl --user stop hypridle
    on-battery = systemctl --user start hypridle
}
